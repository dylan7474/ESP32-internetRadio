#!/usr/bin/env bash
set -e

missing=()

check_cmd() {
  if ! command -v "$1" >/dev/null 2>&1; then
    echo "Missing required tool: $1"
    missing+=("$1")
  fi
}

check_pkg() {
  if ! pkg-config --exists "$1"; then
    echo "Missing required library: $1"
    missing+=("$1")
  fi
}

check_cmd gcc
check_cmd sdl2-config
check_cmd pkg-config

if command -v pkg-config >/dev/null 2>&1; then
  check_pkg SDL2_ttf
  check_pkg fftw3
else
  echo "pkg-config not found; skipping library checks"
fi

if [ ${#missing[@]} -ne 0 ]; then
  echo
  echo "The following components are missing:"
  for m in "${missing[@]}"; do
    echo "  - $m"
  done
  echo
  echo "Install them on Debian/Ubuntu with:"
  echo "  sudo apt-get install build-essential libsdl2-dev libsdl2-ttf-dev libfftw3-dev pkg-config"
  exit 1
else
  echo "All required tools and libraries are available."
fi
